{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c14c993c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#\n",
    "# -------------------------------------------------------------------------------------------------------------------\n",
    "#                                                Logistic Regression 개념\n",
    "# -------------------------------------------------------------------------------------------------------------------\n",
    "#\n",
    "# [개념]\n",
    "# 로지스틱 회귀모델은 확률 p 의 odds 를 선형모형으로 모델링한 것\n",
    "# - z = logit(p) = log (p / (1 - p)) = log (odds(p)) =β0 + β1x1 + β2x2 + ... + βkxk\n",
    "#\n",
    "# 확률 p 는 회귀모델 출력값 z 로 구성된 로지스틱 함수의 형태\n",
    "# - P( Y = 1 | X ) = 1 / ( 1 + e^(-z) ) ......... 독립변수 X 가 주어졌을 때 1 로 분류될 확률\n",
    "#     → z = log ( p / ( 1 - p ) ) \n",
    "#     → e^z = p / ( 1 - p )\n",
    "#     → ( 1 - p ) * e^z = p   →   e^z - p * e^z = p   →   e^ z = ( 1 + e^z ) * p \n",
    "#     → p = e^z / ( 1 + e^z ) = 1 / (1 + e^(-z))\n",
    "#\n",
    "# 로지스틱 함수는 입력(z) 에 무관하게 0 ~ 1 사이의 값을 갖아 확률값 모델에 유용 ... 이 경우는 우연의 일치겠지만\n",
    "# - f(z) = 1 / (1 + e^(-z)) = e^z / ( e^z + 1 )\n",
    "#\n",
    "# 로직스틱 회귀모델의 회귀식에서 구해진 z 를 로지스틱 함수의 입력으로 넣은 결과가 X 가 주어졌을 때 Y 가 1 로 분류될 확률\n",
    "# - P( Y = 1 | X ) = e^z / ( e^z + 1 )\n",
    "#                  = e^(β0 + β1x1 + β2x2 + ... + βkxk) / ( 1 + e^(β0 + β1x1 + β2x2 + ... + βkxk))\n",
    "# \n",
    "# 오즈비율(odds_ratio)을 통해 독립변수의 영항력을 해석과 비교\n",
    "# - 특정 독립변수의 오즈비율 (odds ratio) 는 odds(x + 1) / odds(x) = e^(βi)  .... 모델 적합해서 구한 회귀계수에 지수를 취한 것!!\n",
    "#   . 오즈 비율이 1보다 크거나 작으면, 해당 독립 변수의 단위 증가가 종속 변수가 1이 될 확률을 증가 또는 감소\n",
    "#   . 오즈 비율이 1보다 크면, 해당 독립 변수의 단위 증가가 종속 변수가 1이 될 확률을 증가\n",
    "#\n",
    "# [오즈 비율 유도]\n",
    "# - P(Y=1|X) = 1 / (1 + e^(-z)) , z = β0 + β1X1 + β2X2 + ... + βkXk 일때  X1 의 오즈비율은 e^(β1)\n",
    "#    → odds_ratio  = odds_after / odds_before \n",
    "#    → odds_after  = P(Y=1|X1=x+1) / P(Y=0|X1=x+1) = e^(z+β1) / (1 + e^(z+β1))\n",
    "#       .... z' = β0 + β1(X1 + 1) + β2X2 + ... + βkXk = (β0 + β1X1 + β2X2 + ... + βkXk) + β1 = z + β1\n",
    "#       .... P(Y=1|X1=x+1) = 1 / (1 + e^(-z')) = e^(z') / (1 + e^(z')) = e^(z+β1) / (1 + e^(z+β1))\n",
    "#       .... P(Y=0|X1=x+1) = 1 - P(Y=1|X1=x+1) = 1 - e^(z+β1) / (1 + e^(z+β1)) = 1 / (1 + e^(z+β1))\n",
    "#    → odds_before = P(Y=1|X1=x)   / P(Y=0|X1=x)   = e^(z) / (1 + e^(z))\n",
    "#       .... P(Y=1|X1=x) = 1 / (1 + e^(-z)) = e^z / (1 + e^z)\n",
    "#       .... P(Y=0|X1=x) = 1 - P(Y=1|X1=x) = 1 - e^z / (1 + e^z) = (1 + e^z - e^z) / (1 + e^z) = 1 / (1 + e^z)                    \n",
    "#    → odss_ratio = odds_after / odds_before = e^(β1) \n",
    "#       .... { e^(z+β1) / (1 + e^(z+β1)) } / { 1 / (1 + e^z) }  \n",
    "#"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "id": "961f487d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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xAxAYmKi1qxZo8TExEi3MqgxzuHBOIcPYx0ejHN4RMM4D9oLewEAwODGTAwAALASIQYAAFiJEAMAAKxEiAEAAFYixHTjiSeeUE5OjpKSklRQUKA9e/b0WF9eXq6CggIlJSVp1KhR+tGPfhSmTu3Wn3H++c9/runTp2v48OFKS0vTxIkT9atf/SqM3dqrv3+fO7z++uuKi4vTVVddFdoGB4n+jnNra6vuv/9+jRw5UomJibr00kv1b//2b2Hq1m79HevnnntOV155pYYMGaKsrCz9wz/8g06ePBmmbu302muvafbs2fJ4PHI4HPrFL37R63fCfiw06GL79u0mPj7ebN682VRXV5u7777bpKSkmCNHjlyw/v333zdDhgwxd999t6murjabN2828fHx5qc//WmYO7dLf8f57rvvNuvWrTMVFRXm3XffNatXrzbx8fHmwIEDYe7cLv0d5w4ff/yxGTVqlCksLDRXXnlleJq12EDGec6cOWbChAmmrKzM1NTUmN/85jfm9ddfD2PXdurvWO/Zs8fExMSYH/7wh+b99983e/bsMVdccYW55ZZbwty5XXbu3Gnuv/9+87Of/cxIMjt27OixPhLHQkLMBYwfP94sWbIkYNvll19uVq1adcH6++67z1x++eUB2xYvXmyuvfbakPU4GPR3nC8kLy/PFBcXB7u1QWWg4zxv3jzzve99z6xZs4YQ0wf9HeeXX37ZOJ1Oc/LkyXC0N6j0d6wffPBBM2rUqIBtjz76qBkxYkTIehxs+hJiInEs5HRSJ21tbaqsrFRhYWHA9sLCQu3bt++C33njjTe61M+YMUNvvfWWzp49G7JebTaQce7M5/OpqalJ6enpoWhxUBjoOD/99NN67733tGbNmlC3OCgMZJxffPFFjRs3TuvXr9fnP/95XXbZZVqxYoWam5vD0bK1BjLWkyZN0rFjx7Rz504ZY/Thhx/qpz/9qW6++eZwtHzRiMSxcNA+AHKgTpw4ofb2drlcroDtLpdLdXV1F/xOXV3dBevPnTunEydOKCsrK2T92mog49zZQw89pDNnzmju3LmhaHFQGMg4//73v9eqVau0Z88excXxn4i+GMg4v//++9q7d6+SkpK0Y8cOnThxQkuXLtWpU6e4LqYHAxnrSZMm6bnnntO8efPU0tKic+fOac6cOXrsscfC0fJFIxLHQmZiuuFwOALeG2O6bOut/kLbEai/49zh+eef19q1a/XCCy8oMzMzVO0NGn0d5/b2ds2fP1/FxcW67LLLwtXeoNGfv88+n08Oh0PPPfecxo8fr5tuukkbNmzQM888w2xMH/RnrKurq/Wd73xH3//+91VZWaldu3appqZGS5YsCUerF5VwHwv536xOhg0bptjY2C6Jvr6+vkvC7OB2uy9YHxcXp4yMjJD1arOBjHOHF154QYsWLdJPfvITTZs2LZRtWq+/49zU1KS33npLBw8e1F133SXp/MHWGKO4uDjt3r1bX/7yl8PSu00G8vc5KytLn//85+V0Ov3bRo8eLWOMjh07ptzc3JD2bKuBjHVpaamuu+463XvvvZKkL33pS0pJSdENN9ygf/mXf2G2PEgicSxkJqaThIQEFRQUqKysLGB7WVmZJk2adMHvTJw4sUv97t27NW7cOMXHx4esV5sNZJyl8zMwt99+u7Zt28b57D7o7zinpaXp7bff1qFDh/yvJUuW6Itf/KIOHTqkCRMmhKt1qwzk7/N1112n48eP6/Tp0/5t7777rmJiYjRixIiQ9muzgYz1J598opiYwMNdbGyspL/MFOCzi8ixMGSXDFus4/a9p556ylRXV5uioiKTkpJi/vjHPxpjjFm1apVZuHChv77jtrLvfve7prq62jz11FPcYt0H/R3nbdu2mbi4OPP444+b2tpa/+vjjz+O1E+wQn/HuTPuTuqb/o5zU1OTGTFihPna175mDh8+bMrLy01ubq75x3/8x0j9BGv0d6yffvppExcXZ5544gnz3nvvmb1795px48aZ8ePHR+onWKGpqckcPHjQHDx40EgyGzZsMAcPHvTfyh4Nx0JCTDcef/xxM3LkSJOQkGDGjh1rysvL/Z/ddtttZvLkyQH1//Vf/2Wuvvpqk5CQYL7whS+YTZs2hbljO/VnnCdPnmwkdXnddttt4W/cMv39+/xphJi+6+84v/POO2batGkmOTnZjBgxwtxzzz3mk08+CXPXdurvWD/66KMmLy/PJCcnm6ysLLNgwQJz7NixMHdtl1dffbXH/+ZGw7HQYQxzaQAAwD5cEwMAAKxEiAEAAFYixAAAACsRYgAAgJUIMQAAwEqEGAAAYCVCDAAAsBIhBgAAWIkQAwAArESIAQAAViLEAAAAKxFiAACAlf4/TTXWdF+TsmkAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\chsun\\AppData\\Local\\Temp\\ipykernel_34064\\3055881803.py:27: RuntimeWarning: divide by zero encountered in log\n",
      "  log_y = np.log(y)\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "Intercept    0.632653\n",
       "rank        -0.567486\n",
       "dtype: float64"
      ]
     },
     "execution_count": 91,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#\n",
    "# 오즈(Odds)\n",
    "# - 사건이 발생할 확률이 그렇지 않을 확률보다 몇 배가 더 큰가? \n",
    "#   . Odds (A) = P (A) / ( 1 - P(A) )\n",
    "# \n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from statsmodels.formula.api import ols\n",
    "# 대학교 입학 데이터\n",
    "data = pd.read_csv(\"./data/admission2.csv\")\n",
    "\n",
    "# Odds (Admit)\n",
    "# - Odds 값 '1' 을 기준으로 낮은 경우 , 발생하기 어렵다는 의미\n",
    "prob_admit = data['admit'].mean()   # 0.372\n",
    "odds_admit = prob_admit / (1 - prob_admit)     # 0.465   →  입학할 확률이 그렇지 않을 확률보다 작음\n",
    "\n",
    "# Odds 값의 범위\n",
    "# - x : 확률 , y : 오즈\n",
    "x = np.arange(0, 1, 0.001)\n",
    "y = x / (1 - x)\n",
    "plt.scatter(x, y)\n",
    "plt.show()\n",
    "\n",
    "# log(odds)\n",
    "log_y = np.log(y)\n",
    "plt.scatter(x, log_y)\n",
    "plt.show()\n",
    "\n",
    "# 범주형 변수의 Odds\n",
    "# - rank 별 : 입학 확률, odds  \n",
    "prob_admit_rank = data.groupby('rank')['admit'].sum() / data.groupby('rank')['admit'].count()\n",
    "odds_admit_rank = prob_admit_rank / (1 - prob_admit_rank)\n",
    "df = pd.DataFrame()\n",
    "df['prob_admit'] = prob_admit_rank\n",
    "df['odds_admit'] = odds_admit_rank\n",
    "df['log_odds_admit'] = np.log(df['odds_admit'])\n",
    "df.reset_index(inplace = True)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "id": "8dbb912d",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>rank</th>\n",
       "      <th>prob_admit</th>\n",
       "      <th>odds_admit</th>\n",
       "      <th>log_odds_admit</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>0.540984</td>\n",
       "      <td>1.178571</td>\n",
       "      <td>0.164303</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>0.357616</td>\n",
       "      <td>0.556701</td>\n",
       "      <td>-0.585727</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>0.231405</td>\n",
       "      <td>0.301075</td>\n",
       "      <td>-1.200395</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   rank  prob_admit  odds_admit  log_odds_admit\n",
       "0     1    0.540984    1.178571        0.164303\n",
       "1     2    0.357616    0.556701       -0.585727\n",
       "2     3    0.231405    0.301075       -1.200395"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "(array([[-0.57742887]]), array([0.61624871]))"
      ]
     },
     "execution_count": 100,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#\n",
    "# Logistic Regression 의 개념적 접근\n",
    "# [NOTE] 하단 접근법은 올바르지 않지만 개념 이해를 위한 것\n",
    "# \n",
    "# 범주형 변수의 Odds\n",
    "# - rank 별 : 입학 확률, odds  \n",
    "prob_admit_rank = data.groupby('rank')['admit'].sum() / data.groupby('rank')['admit'].count()\n",
    "odds_admit_rank = prob_admit_rank / (1 - prob_admit_rank)\n",
    "df = pd.DataFrame()\n",
    "df['prob_admit'] = prob_admit_rank\n",
    "df['odds_admit'] = odds_admit_rank\n",
    "df['log_odds_admit'] = np.log(df['odds_admit'])\n",
    "df.reset_index(inplace = True)\n",
    "display(df.head(3))\n",
    "\n",
    "\n",
    "# Conceptual Logitsitc Regression (정확한 것이 아니고 개념적으로만)\n",
    "model = ols(formula = 'log_odds_admit ~ rank', data = df).fit()\n",
    "model.params\n",
    "# Intercept    0.632653\n",
    "# rank        -0.567486\n",
    "\n",
    "# rank 회귀계수의 의미는 rank 가 1 증가하면 합격 odds 가 0.567 줄어든다는 의미\n",
    "# → 직관적이지 않으므로 회귀식의 양변에 지수를 취함\n",
    "# \n",
    "# 회귀식은 아래와 같이 정의됨\n",
    "#   log (odds_rank) = 0.62 - 0.57*x \n",
    "#   → odds_rank = exp (0.62 - 0.57*x) = exp(0.62) * exp(-0.57*x)\n",
    "#\n",
    "# * [참고] 오즈비(Odds Ratio)를 통해서도 이 경향성을 동일하게 파악할 수 있음\n",
    "#   - 오즈비(Odds Ratio)는 한 단위 증가할 때의 Odds 증가량\n",
    "#     Odds(x_rank + 1) / Odds(x_rank) \n",
    "#     = {epx(0.632) * exp(-0.567*(x + 1)} /  { exp (0.632) * exp(-0.567*x) } \n",
    "#     = exp(-0.567*(x + 1)) / exp(-0.567*x)   \n",
    "#     = exp(-0.567) = 0.567 \n",
    "# \n",
    "# 오즈를 이용한 확률 역산 : P(A) = odds / (odds + 1)\n",
    "# - P(x_rank) =   exp (0.62 - 0.57*x) / (  exp (0.62 - 0.57*x) + 1)\n",
    "# - 이를 통해서 각 등급별 입학 확률을 계산 할 수 있음\n",
    "# \n",
    "prob_admit_rank2 = np.exp (0.72 - 0.57 * df['rank']) / ( np.exp (0.72 - 0.57 * df['rank']) + 1)\n",
    "prob_admit_rank2, prob_admit_rank  # 유사함을 볼 수 있음\n",
    "\n",
    "\n",
    "# sklearn.linear_model.LogisticRegression 적합을 통해 어느정도 유사함을 볼 수 있음\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "model = LogisticRegression(random_state=1234).fit(data[['rank']],data['admit'])\n",
    "model.coef_ , model.intercept_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 169,
   "id": "1006a022",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>admit</th>\n",
       "      <th>gre</th>\n",
       "      <th>gpa</th>\n",
       "      <th>ses</th>\n",
       "      <th>gender</th>\n",
       "      <th>race</th>\n",
       "      <th>rank</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>380</td>\n",
       "      <td>3.61</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>660</td>\n",
       "      <td>3.67</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>800</td>\n",
       "      <td>4.00</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   admit  gre   gpa  ses  gender  race  rank\n",
       "0      0  380  3.61    1       0     3     3\n",
       "1      1  660  3.67    2       0     2     3\n",
       "2      1  800  4.00    2       0     2     1"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>admit</th>\n",
       "      <th>gre</th>\n",
       "      <th>gpa</th>\n",
       "      <th>ses</th>\n",
       "      <th>gender</th>\n",
       "      <th>race</th>\n",
       "      <th>rank</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>400.000000</td>\n",
       "      <td>400.000000</td>\n",
       "      <td>400.000000</td>\n",
       "      <td>400.000000</td>\n",
       "      <td>400.000</td>\n",
       "      <td>400.000000</td>\n",
       "      <td>400.00000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>0.317500</td>\n",
       "      <td>587.700000</td>\n",
       "      <td>3.389900</td>\n",
       "      <td>1.992500</td>\n",
       "      <td>0.475</td>\n",
       "      <td>1.962500</td>\n",
       "      <td>2.48500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>0.466087</td>\n",
       "      <td>115.516536</td>\n",
       "      <td>0.380567</td>\n",
       "      <td>0.808751</td>\n",
       "      <td>0.500</td>\n",
       "      <td>0.823279</td>\n",
       "      <td>0.94446</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>220.000000</td>\n",
       "      <td>2.260000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.00000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>520.000000</td>\n",
       "      <td>3.130000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>2.00000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>580.000000</td>\n",
       "      <td>3.395000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>0.000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>2.00000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>660.000000</td>\n",
       "      <td>3.670000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>3.00000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>800.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>4.00000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            admit         gre         gpa         ses   gender        race  \\\n",
       "count  400.000000  400.000000  400.000000  400.000000  400.000  400.000000   \n",
       "mean     0.317500  587.700000    3.389900    1.992500    0.475    1.962500   \n",
       "std      0.466087  115.516536    0.380567    0.808751    0.500    0.823279   \n",
       "min      0.000000  220.000000    2.260000    1.000000    0.000    1.000000   \n",
       "25%      0.000000  520.000000    3.130000    1.000000    0.000    1.000000   \n",
       "50%      0.000000  580.000000    3.395000    2.000000    0.000    2.000000   \n",
       "75%      1.000000  660.000000    3.670000    3.000000    1.000    3.000000   \n",
       "max      1.000000  800.000000    4.000000    3.000000    1.000    3.000000   \n",
       "\n",
       "            rank  \n",
       "count  400.00000  \n",
       "mean     2.48500  \n",
       "std      0.94446  \n",
       "min      1.00000  \n",
       "25%      2.00000  \n",
       "50%      2.00000  \n",
       "75%      3.00000  \n",
       "max      4.00000  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Optimization terminated successfully.\n",
      "         Current function value: 0.573786\n",
      "         Iterations 6\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([[2.81960331e-02, 3.24928845e-02, 1.32605153e-05, 5.40521161e-01,\n",
       "        4.98413636e-03]])"
      ]
     },
     "execution_count": 169,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#\n",
    "# -------------------------------------------------------------------------------------------------------------------\n",
    "#                                         Logistic Regression 모델 적합과 회귀계수의 검정\n",
    "# -------------------------------------------------------------------------------------------------------------------\n",
    "#\n",
    "# \n",
    "# Likelihood ratio Test(LR 검정)로 모델 유의성 검정\n",
    "# - 귀무가설 : β = 0 , 대립가설 : 0 이 아닌 회귀계수가 존재\n",
    "# - 검정 통계량 : Λ = -2 * ( l(β_hat_null) - l(β_hat) ) ~ κ²(k - r)     * l() 은 log_likelihood \n",
    "#\n",
    "# Wald Test로 통한 회귀 계수 유의성 검정\n",
    "# - 귀무가설 : βi = 0 , 대립가설 : βi ≠ 0\n",
    "# - 검정 통계량 : z = β_hat / SE_β_hat ~ N ( 0, 1² )\n",
    "\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "from scipy.stats import norm\n",
    "from statsmodels.formula.api import logit\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "def gender_replace(x):\n",
    "    if(x == 'F'):\n",
    "        return 0\n",
    "    elif(x == 'M'):\n",
    "        return 1\n",
    "    else:\n",
    "        return None\n",
    "\n",
    "data = pd.read_csv('./data/admission2.csv')\n",
    "data = data.rename(columns=lambda x : x.lower())\n",
    "data['gender'] = data['gender'].apply(func = gender_replace)\n",
    "display(data.head(3))\n",
    "display(data.describe())\n",
    "\n",
    "#\n",
    "# (1) statsmodels.formula.api.logit 을 통해 모델 적합하고 검정 결과를 summary() 를 통해 확인\n",
    "#\n",
    "model1 = logit(formula='admit ~ gre + gpa + rank + gender',data=data).fit()\n",
    "# 모델 적합 결과를 summary() 를 통해 확인 가능 \n",
    "# - LR 검정 결과(모델 유의성)        : LLR p-value  (귀무가설 : 회귀식의 모든 회귀계수는 모두 0 임) → 즉, 회귀식이 의미가 없고 평균값을 의미하는 절편이 최선임\n",
    "# - Wald 검정 결과(회귀계수의 유의성) : P > |z|      (귀무가설 : 특정 회귀계수는 0 임)\n",
    "#\n",
    "# Logit Regression Results\n",
    "# Dep. Variable:\tadmit\t    No. Observations:\t400\n",
    "# Model:\tLogit\t            Df Residuals:\t395\n",
    "# Method:\tMLE\t                Df Model:\t4\n",
    "# Date:\tMon, 03 Apr 2023\t    Pseudo R-squ.:\t0.08190\n",
    "# Time:\t12:18:27\t            Log-Likelihood:\t-229.51\n",
    "# converged:\tTrue\t        LL-Null:\t-249.99\n",
    "# Covariance Type:\tnonrobust\tLLR p-value:\t2.756e-08\n",
    "#            coef\t    std err\tz\t    P>|z|\t[0.025\t0.975]\n",
    "# Intercept\t-3.3667\t    1.141\t-2.952\t0.003\t-5.602\t-1.131\n",
    "# gre\t     0.0023\t    0.001\t2.109\t0.035\t0.000\t0.004\n",
    "# gpa\t     0.7733\t    0.328\t2.358\t0.018\t0.131\t1.416\n",
    "# rank\t    -0.5634\t    0.127\t-4.419\t0.000\t-0.813\t-0.313\n",
    "# gender\t-0.1459\t    0.227\t-0.642\t0.521\t-0.591\t0.299\n",
    "model1.summary()\n",
    "\n",
    "#\n",
    "# (2) sklearn.linear_model.LogisticRegression 을 통해 모델 적합하고 직접 검정해보기\n",
    "#- \n",
    "\n",
    "# 모델 적합\n",
    "# admit ~ gre + gap + rank + gender\n",
    "y = data['admit']\n",
    "X = data[['gre','gpa','rank','gender']]\n",
    "model2 = LogisticRegression(random_state=1234).fit(X=X,y=y)\n",
    "# model.intercept_ , model.coef_\n",
    "# [-3.18837101], [ 0.00239433,  0.69778363, -0.55295011, -0.13872399]\n",
    "\n",
    "#\n",
    "# 모델 유의성 검정 : Likelihoood Ratio Test (LR Test)\n",
    "# - Λ = -2 * ( l(β_hat_null) - l(β_hat) ) ~ κ²(k - r)\n",
    "\n",
    "\n",
    "\n",
    "#\n",
    "# 회귀계수 검정 : Wald Test\n",
    "# - zi = β-i / standard_error_i\n",
    "#\n",
    "# 1. 피처 행렬 X를 구성 (n은 샘플의 개수, k는 독립변수의 개수, 여기서는 절편(intercept) 항까지 포함합니다).\n",
    "# 2. 각 샘플의 예측 확률을 구함\n",
    "#    - P(Y=1|X) = 1 / (1 + e^(-z))\n",
    "# 3. 예측 확률을 사용하여 각 샘플의 가중치 행렬 V를 구함\n",
    "#    - V = diag(P(Y=1|X) * (1 - P(Y=1|X)))\n",
    "# 4. 피처 행렬 X와 가중치 행렬 V를 사용하여 공분산 행렬을 구합\n",
    "#    - cov_matrix = (X.T * V * X)^(-1)\n",
    "# 5. 공분산 행렬의 대각 성분에서 표준 오차 구함\n",
    "#    - standard_errors = sqrt(diag(cov_matrix))\n",
    "# 6. 검정 통계량을 계산하고 분포에서 확인\n",
    "#    - z = β-i / standard_error_i\n",
    "\n",
    "# 2. 각 샘플의 예측 확률을 구함\n",
    "probability = model2.predict_proba(X)\n",
    "# 3. 예측 확률을 사용하여 각 샘플의 가중치 행렬 V를 구함\n",
    "V = np.diag(probability[:, 0] * probability[:, 1])\n",
    "X = X.assign(intercept=1)\n",
    "\n",
    "# 4. 피처 행렬 X와 가중치 행렬 V를 사용하여 공분산 행렬을 구합\n",
    "cov_matrix = np.linalg.inv(X.T @ V @ X)\n",
    "\n",
    "#  5. 공분산 행렬의 대각 성분에서 표준 오차 구함\n",
    "standard_errors = np.sqrt(np.diag(cov_matrix))\n",
    "standard_errors   # [1.09103687e-03, 3.26327254e-01, 1.26946831e-01, 2.26663903e-01, 1.13543661e+00]\n",
    "model2.coef_      # [ 0.00239433,  0.69778363, -0.55295011, -0.13872399]\n",
    "model2.intercept_ # [-3.18837101]\n",
    "coefs_with_intercept = np.concatenate([model2.coef_, [model2.intercept_]], axis=1)\n",
    "\n",
    "# 6. 검정 통계량을 계산하고 분포에서 확인\n",
    "z_statistics = coefs_with_intercept / standard_errors\n",
    "p_values = 2 * (1 - norm.cdf(np.abs(z_statistics)))\n",
    "p_values          # [2.81960331e-02, 3.24928845e-02, 1.32605153e-05, 5.40521161e-01,4.98413636e-03]"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
